import streamlit as st
import pandas as pd
import os

st.set_page_config(page_title="‡∏ß‡∏±‡∏™‡∏î‡∏∏ | Material Form", layout="centered")
st.title("üì¶ ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏™‡∏î‡∏∏")

# ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î ‚Üí ‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠ ‚Üí ‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•
location_data = {
    "‡∏Å‡∏£‡∏∏‡∏á‡πÄ‡∏ó‡∏û‡∏°‡∏´‡∏≤‡∏ô‡∏Ñ‡∏£": {
        "‡πÄ‡∏Ç‡∏ï‡∏ö‡∏≤‡∏á‡∏£‡∏±‡∏Å": ["‡πÅ‡∏Ç‡∏ß‡∏á‡∏™‡∏µ‡∏•‡∏°", "‡πÅ‡∏Ç‡∏ß‡∏á‡∏™‡∏∏‡∏£‡∏¥‡∏¢‡∏ß‡∏á‡∏®‡πå"],
        "‡πÄ‡∏Ç‡∏ï‡∏õ‡∏ó‡∏∏‡∏°‡∏ß‡∏±‡∏ô": ["‡πÅ‡∏Ç‡∏ß‡∏á‡∏£‡∏≠‡∏á‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡πÅ‡∏Ç‡∏ß‡∏á‡∏ß‡∏±‡∏á‡πÉ‡∏´‡∏°‡πà"]
    },
    "‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà": {
        "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà": ["‡∏ï‡∏≥‡∏ö‡∏•‡∏®‡∏£‡∏µ‡∏†‡∏π‡∏°‡∏¥", "‡∏ï‡∏≥‡∏ö‡∏•‡∏ä‡πâ‡∏≤‡∏á‡∏°‡πà‡∏≠‡∏¢"],
        "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏™‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏¢": ["‡∏ï‡∏≥‡∏ö‡∏•‡∏´‡∏ô‡∏≠‡∏á‡πÅ‡∏´‡∏¢‡πà‡∏á", "‡∏ï‡∏≥‡∏ö‡∏•‡πÅ‡∏°‡πà‡πÅ‡∏ù‡∏Å"]
    },
    "‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ": {
        "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏ä‡∏•‡∏ö‡∏∏‡∏£‡∏µ": ["‡∏ï‡∏≥‡∏ö‡∏•‡∏ö‡∏≤‡∏á‡∏õ‡∏•‡∏≤‡∏™‡∏£‡πâ‡∏≠‡∏¢", "‡∏ï‡∏≥‡∏ö‡∏•‡∏ö‡πâ‡∏≤‡∏ô‡∏™‡∏ß‡∏ô"],
        "‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ö‡∏≤‡∏á‡∏•‡∏∞‡∏°‡∏∏‡∏á": ["‡∏ï‡∏≥‡∏ö‡∏•‡∏ô‡∏≤‡πÄ‡∏Å‡∏•‡∏∑‡∏≠", "‡∏ï‡∏≥‡∏ö‡∏•‡∏´‡∏ô‡∏≠‡∏á‡∏õ‡∏£‡∏∑‡∏≠"]
    }
}

csv_path = "materials_data.csv"
if os.path.exists(csv_path):
    materials_df = pd.read_csv(csv_path)
else:
    materials_df = pd.DataFrame(columns=[
        "‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏™‡∏î‡∏∏", "‡∏Å‡∏ß‡πâ‡∏≤‡∏á (mm)", "‡∏•‡∏∂‡∏Å (mm)", "‡∏¢‡∏≤‡∏ß (mm)", "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", "‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠", "‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•"
    ])

# ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°
with st.form("material_form", clear_on_submit=True):
    name = st.text_input("‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏ß‡∏±‡∏™‡∏î‡∏∏")

    col1, col2, col3 = st.columns(3)
    with col1:
        width = st.number_input("‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á (mm)", min_value=0.0, step=0.1)
    with col2:
        depth = st.number_input("‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (mm)", min_value=0.0, step=0.1)
    with col3:
        length = st.number_input("‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß (mm)", min_value=0.0, step=0.1)

    province = st.selectbox("‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î", list(location_data.keys()))
    district = st.selectbox("‡πÄ‡∏Ç‡∏ï / ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠", list(location_data[province].keys()))
    subdistrict = st.selectbox("‡πÅ‡∏Ç‡∏ß‡∏á / ‡∏ï‡∏≥‡∏ö‡∏•", location_data[province][district])

    submit = st.form_submit_button("üì• ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏™‡∏î‡∏∏")

    if submit:
        new_data = {
            "‡∏ä‡∏∑‡πà‡∏≠‡∏ß‡∏±‡∏™‡∏î‡∏∏": name,
            "‡∏Å‡∏ß‡πâ‡∏≤‡∏á (mm)": width,
            "‡∏•‡∏∂‡∏Å (mm)": depth,
            "‡∏¢‡∏≤‡∏ß (mm)": length,
            "‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î": province,
            "‡πÄ‡∏Ç‡∏ï/‡∏≠‡∏≥‡πÄ‡∏†‡∏≠": district,
            "‡πÅ‡∏Ç‡∏ß‡∏á/‡∏ï‡∏≥‡∏ö‡∏•": subdistrict
        }
        materials_df = pd.concat([materials_df, pd.DataFrame([new_data])], ignore_index=True)
        materials_df.to_csv(csv_path, index=False, encoding="utf-8-sig")
        st.success("‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!")

if not materials_df.empty:
    st.markdown("---")
    st.subheader("üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ß‡∏±‡∏™‡∏î‡∏∏‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î")
    st.dataframe(materials_df, use_container_width=True)
